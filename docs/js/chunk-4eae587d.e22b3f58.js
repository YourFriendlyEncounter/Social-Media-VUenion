(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4eae587d"],{"079e":function(t,e,s){"use strict";var n=s("3613"),i=s.n(n);i.a},"21c0":function(t,e,s){},2532:function(t,e,s){"use strict";var n=s("23e7"),i=s("5a34"),r=s("1d80"),o=s("ab13");n({target:"String",proto:!0,forced:!o("includes")},{includes:function(t){return!!~String(r(this)).indexOf(i(t),arguments.length>1?arguments[1]:void 0)}})},"2f65":function(t,e,s){var n={"./anonymous.svg":"2456","./newUser.svg":"6364","./web.svg":"c31f"};function i(t){var e=r(t);return s(e)}function r(t){if(!s.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}i.keys=function(){return Object.keys(n)},i.resolve=r,t.exports=i,i.id="2f65"},"355a":function(t,e,s){"use strict";var n=s("21c0"),i=s.n(n);i.a},3613:function(t,e,s){},"3ca3":function(t,e,s){"use strict";var n=s("6547").charAt,i=s("69f3"),r=s("7dd0"),o="String Iterator",a=i.set,c=i.getterFor(o);r(String,"String",(function(t){a(this,{type:o,string:String(t),index:0})}),(function(){var t,e=c(this),s=e.string,i=e.index;return i>=s.length?{value:void 0,done:!0}:(t=n(s,i),e.index+=t.length,{value:t,done:!1})}))},"44e7":function(t,e,s){var n=s("861d"),i=s("c6b6"),r=s("b622"),o=r("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},4787:function(t,e,s){"use strict";s.r(e);var n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"feed"}},[t.checkUser?s("form",{attrs:{id:"form-new-post"},on:{submit:function(e){return e.preventDefault(),t.newPost(e)}}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newPostText,expression:"newPostText"}],staticClass:"input-text",attrs:{id:"new-post-text",rows:"3",maxlength:"3000",placeholder:"Что интересного можете рассказать?"},domProps:{value:t.newPostText},on:{input:function(e){e.target.composing||(t.newPostText=e.target.value)}}}),t._v(" "),s("input",{staticClass:"custom-button",attrs:{type:"submit",id:"new-post-submit"}})]):t._e(),t._l(t.getPosts,(function(e){return s("div",{key:e.id,staticClass:"container-white post-generic"},[s("div",{staticClass:"post-author-info"},[s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("div",{staticClass:"post-author-photo-block"},[s("img",{attrs:{src:t.getImageURL(e.user).link,width:"48",height:"48"}})]),s("div",{staticClass:"post-author-name-date-block"},[s("router-link",{staticClass:"link-user",attrs:{to:{name:"UserProfile",params:{id:e.user}}}},[t._v(" "+t._s(t.getAuthorById(e.user).name)+" "+t._s(t.getAuthorById(e.user).lastName)+" ")]),s("p",[t._v(" "+t._s(t.getRelativeDate(e.dateTimeAdded))+" ")])],1)]),t.getUser.id==e.user||t.isUserAdmin?s("a",{staticClass:"post-delete",attrs:{href:"#"},on:{click:function(s){return t.deletePostOrComment(e)}}},[t._v("X")]):t._e()]),s("p",{staticClass:"post-text"},[t._v(t._s(e.text))]),s("hr"),s("Rating",{attrs:{post:e,showComment:!0}}),s("div",{staticClass:"post-comment-section"},[s("hr"),t._l(t.getComments(e.id),(function(e){return s("Comment",{key:e.id,attrs:{comment:e,deletePostOrComment:t.deletePostOrComment,getImageURL:t.getImageURL,getAuthorById:t.getAuthorById,getRelativeDate:t.getRelativeDate,isUserAdmin:t.isUserAdmin,isReply:!1}})})),t.checkUser&&e.showComment?s("NewComment",{attrs:{post:e,userImage:t.getImageURL(t.getUser.id).link}}):t._e()],2)],1)}))],2)},i=[],r=(s("4de4"),s("fb6a"),s("d3b7"),s("25f0"),s("3ca3"),s("9911"),s("ddb0"),s("96cf"),s("1da1")),o=s("f3db"),a=s("d719"),c=s.n(a),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"div-likes-dislikes"},[n("p",{staticClass:"p-difference"},[t._v(t._s(t.getDifference))]),n("div",{staticClass:"tooltip"},[n("div",{staticClass:"div-tooltip-inside"},[n("h2",[t._v(t._s(t.getRatesCount(t.post.liked)))])]),n("button",{staticClass:"button-transparent-clickable button-like",class:{"is-post-liked":t.isPostLiked(t.post)},on:{click:function(e){return t.likePost(t.post)}}},[n("img",{attrs:{src:s("8e44"),width:"24"}})])]),n("div",{staticClass:"tooltip"},[n("div",{staticClass:"div-tooltip-inside"},[n("h2",[t._v(t._s(t.getRatesCount(t.post.disliked)))])]),n("button",{staticClass:"button-transparent-clickable button-dislike",class:{"is-post-disliked":t.isPostDisliked(t.post)},on:{click:function(e){return t.dislikePost(t.post)}}},[n("img",{attrs:{src:s("fcd3"),width:"24"}})])]),t.showComment?n("button",{staticClass:"button-transparent-clickable button-comment",class:{"is-post-liked":1==t.post.showComment},on:{click:t.showCommentClicked}},[n("img",{attrs:{src:s("e306"),width:"24"}})]):t._e()])])},d=[],l=(s("caad"),s("2532"),{methods:{getRatesCount:function(t){return void 0==t?0:t.length},isPostLiked:function(t){return!(!t.liked||!this.checkUser)&&t.liked.includes(this.getUser.id)},isPostDisliked:function(t){return!(!t.disliked||!this.checkUser)&&t.disliked.includes(this.getUser.id)},likePost:function(t){if(this.checkUser){this.isPostDisliked(t)&&this.dislikePost(t);var e=!1;e=!!this.isPostLiked(t);var s=this.getUser.id;this.$store.dispatch("changeLikes",{post:t,userID:s,isToRemove:e})}else c.a.error("Авторизуйтесь, чтобы оставлять отзывы.")},dislikePost:function(t){if(this.checkUser){this.isPostLiked(t)&&this.likePost(t);var e=!1;e=!!this.isPostDisliked(t);var s=this.getUser.id;this.$store.dispatch("changeDislikes",{post:t,userID:s,isToRemove:e})}else c.a.error("Авторизуйтесь, чтобы оставлять отзывы.")},showCommentClicked:function(){void 0==this.post.showComment&&(this.post.showComment=!1),this.post.showComment=!this.post.showComment,this.$store.dispatch("changeComponentKey")}},computed:{getUser:function(){return this.$store.getters.user},checkUser:function(){return this.$store.getters.checkUser},getDifference:function(){var t=this.getRatesCount(this.post.liked)-this.getRatesCount(this.post.disliked);return t>0&&(t="+"+t),t}},props:{post:Object,showComment:Boolean}}),m=l,h=(s("d1c0"),s("2877")),g=Object(h["a"])(m,u,d,!1,null,"5a972f3b",null),f=g.exports,p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-comment-new",class:{"is-reply-newcomment":t.isReply}},[s("div",{staticClass:"post-commment-image-block"},[s("img",{attrs:{src:t.userImage,width:"32",height:"32"}})]),s("form",{staticClass:"form-new-comment",on:{submit:function(e){return e.preventDefault(),t.newComment(t.post)}}},[s("input",{ref:"commentText",staticClass:"input-text",attrs:{type:"text",placeholder:"Напишите своё мнение..."}}),t._m(0)])])},v=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"button-transparent-clickable",staticStyle:{height:"34px",margin:"0 0 0 4px"}},[n("img",{attrs:{src:s("1959"),width:"32",height:"32"}})])}],k={props:{post:Object,userImage:String,isReply:Boolean},methods:{newComment:function(t){var e=this,s=this.output=this.$refs.commentText.value;if(s.length<3)c.a.error("Нельзя опубликовать комментарий, длиной менее 3 символов.");else{this.$refs.commentText.value="";var n=new o["a"];n.text=s,n.dateTimeAdded=(new Date).toString(),n.images=[],n.edited=!1,n.liked=[],n.disliked=[],n.user=this.$store.getters.user.id,n.type="comment",n.target=t.id,this.$store.dispatch("newPost",n).then((function(){e.sumbitStatus="ok",e.$router.push("/"),c.a.success("Пост опубликован.")})).catch((function(t){e.sumbitStatus=t.message}))}}}},C=k,w=(s("71ff"),Object(h["a"])(C,p,v,!1,null,"132d73a8",null)),b=w.exports,y=s("59ca"),U=s.n(y),R=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-comment-outer",class:{"is-reply":t.isReply}},[s("div",{staticClass:"post-comment"},[s("div",{staticClass:"post-comment-inner"},[t.getUser.id==t.comment.user||t.isUserAdmin?s("a",{staticClass:"post-comment-delete",attrs:{href:"#"},on:{click:function(e){return t.deletePostOrComment(t.comment)}}},[t._v("X")]):t._e(),s("div",{staticClass:"post-author-photo-block"},[s("img",{attrs:{src:t.getImageURL(t.comment.user).link,width:"32",height:"32"}})]),s("div",{staticClass:"post-author-name-date-block"},[s("router-link",{staticClass:"link-user",attrs:{to:{name:"UserProfile",params:{id:t.comment.user}}}},[t._v(" "+t._s(t.getAuthorById(t.comment.user).name)+" "+t._s(t.getAuthorById(t.comment.user).lastName)+" ")]),s("p",[t._v(" "+t._s(t.getRelativeDate(t.comment.dateTimeAdded))+" ")])],1),s("p",{staticStyle:{"margin-left":"0.5rem","max-width":"70%"}},[t._v(t._s(t.comment.text))])]),s("div",[s("Rating",{attrs:{post:t.comment,showComment:!t.isReply}})],1)]),t.isReply?t._e():s("div",{staticClass:"post-comment-replies"},t._l(t.getReplies,(function(e){return s("Comment",{key:e.id,attrs:{comment:e,deletePostOrComment:t.deletePostOrComment,getImageURL:t.getImageURL,getAuthorById:t.getAuthorById,getRelativeDate:t.getRelativeDate,isUserAdmin:t.isUserAdmin,isReply:!0}})})),1),t.checkUser&&t.comment.showComment?s("NewComment",{attrs:{post:t.comment,userImage:t.getImageURL(t.getUser.id).link,isReply:!0}}):t._e()],1)},x=[],P={name:"Comment",components:{Rating:f,Comment:I,NewComment:b},computed:{checkUser:function(){return this.$store.getters.checkUser},getUser:function(){return this.$store.getters.user},getReplies:function(){var t=this;return this.$store.getters.getPosts.slice().filter((function(e){return e.target==t.comment.id}))}},props:{comment:Object,deletePostOrComment:Function,getImageURL:Function,getAuthorById:Function,getRelativeDate:Function,isUserAdmin:Boolean,isReply:Boolean}},_=P,A=(s("079e"),Object(h["a"])(_,R,x,!1,null,"256df1e5",null)),I=A.exports,$={components:{Rating:f,NewComment:b,Comment:I},computed:{getAuthors:function(){return this.$store.getters.getUserList},checkUser:function(){return this.$store.getters.checkUser},getUser:function(){return this.$store.getters.user},getPosts:function(){return this.$store.getters.getPosts.slice().filter((function(t){return"post"==t.type&&"feed"==t.target})).reverse()},isUserAdmin:function(){return this.$store.getters.getUserInfo.isAdmin}},methods:{getAuthorById:function(t){return this.$store.getters.getUserById(t)},getImageURL:function(t){var e=this.userAvatarImageURLs.slice().filter((function(e){return e.id==t}))[0];if(!e){var n=s("2f65");e={id:"",link:n("./anonymous.svg")}}return e},loadImageURLs:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){var s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$store.commit("setLoadingFiles",!0),s=t.getPosts,n=0;case 3:if(!(n<s.length)){e.next=15;break}if(t.getAuthorById(s[n].user).image){e.next=6;break}return e.abrupt("continue",12);case 6:return e.prev=6,e.delegateYield(regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={id:s[n].user,link:""},e.next=3,U.a.storage().ref().child("userAvatars/"+s[n].user).getDownloadURL().then((function(e){i.link=e,t.userAvatarImageURLs.push(i)}));case 3:case"end":return e.stop()}}),e)}))(),"t0",8);case 8:e.next=12;break;case 10:e.prev=10,e.t1=e["catch"](6);case 12:n++,e.next=3;break;case 15:t.$store.commit("setLoadingFiles",!1);case 16:case"end":return e.stop()}}),e,null,[[6,10]])})))()},newPost:function(){var t=this;if(this.newPostText.length<3)c.a.error("Нельзя опубликовать пост, длиной менее 3 символов.");else{var e=new o["a"];e.text=this.newPostText,e.dateTimeAdded=(new Date).toString(),e.images=this.newPostImages,e.edited=!1,e.liked=[],e.disliked=[],e.user=this.$store.getters.user.id,e.type="post",e.target="feed",this.$store.dispatch("newPost",e).then((function(){t.sumbitStatus="ok",t.$router.push("/"),t.newPostText="",t.newPostImages=[]})).catch((function(e){t.sumbitStatus=e.message}))}},getRelativeDate:function(t){var e=new Date(t),s=new Date,n=s-e,i=" мин. назад";if(n=Math.round(n/1e3/60),n>=60){if(n/=60,n=Math.floor(n),i=" ч. назад",n>=24)return e.getDate()+"."+(e.getMonth()+1)+"."+e.getFullYear()+" "+(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()}else if(0===n)return"Только что";return n+i},getComments:function(t){return this.$store.getters.getPosts.slice().filter((function(e){return"comment"==e.type&&e.target==t}))},deletePostOrComment:function(t){var e;e="comment"==t.type?"комментарий":"пост",confirm("Вы уверены, что хотите удалить этот "+e+"? Это действие нельзя будет отменить.")&&this.$store.dispatch("deletePost",t)}},data:function(){return{newPostText:"",newPostImages:[],userAvatarImageURLs:[]}},beforeMount:function(){this.loadImageURLs()},mounted:function(){var t=this;setInterval((function(){return t.$store.dispatch("loadPosts",{target:"feed"})}),3e4)}},D=$,L=(s("355a"),Object(h["a"])(D,n,i,!1,null,"7566222e",null));e["default"]=L.exports},"5a34":function(t,e,s){var n=s("44e7");t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},6547:function(t,e,s){var n=s("a691"),i=s("1d80"),r=function(t){return function(e,s){var r,o,a=String(i(e)),c=n(s),u=a.length;return c<0||c>=u?t?"":void 0:(r=a.charCodeAt(c),r<55296||r>56319||c+1===u||(o=a.charCodeAt(c+1))<56320||o>57343?t?a.charAt(c):r:t?a.slice(c,c+2):o-56320+(r-55296<<10)+65536)}};t.exports={codeAt:r(!1),charAt:r(!0)}},"6fd9":function(t,e,s){},"71ff":function(t,e,s){"use strict";var n=s("6fd9"),i=s.n(n);i.a},"789a":function(t,e,s){},ab13:function(t,e,s){var n=s("b622"),i=n("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(s){try{return e[i]=!1,"/./"[t](e)}catch(n){}}return!1}},caad:function(t,e,s){"use strict";var n=s("23e7"),i=s("4d64").includes,r=s("44d2"),o=s("ae40"),a=o("indexOf",{ACCESSORS:!0,1:0});n({target:"Array",proto:!0,forced:!a},{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("includes")},d1c0:function(t,e,s){"use strict";var n=s("789a"),i=s.n(n);i.a},ddb0:function(t,e,s){var n=s("da84"),i=s("fdbc"),r=s("e260"),o=s("9112"),a=s("b622"),c=a("iterator"),u=a("toStringTag"),d=r.values;for(var l in i){var m=n[l],h=m&&m.prototype;if(h){if(h[c]!==d)try{o(h,c,d)}catch(f){h[c]=d}if(h[u]||o(h,u,l),i[l])for(var g in r)if(h[g]!==r[g])try{o(h,g,r[g])}catch(f){h[g]=r[g]}}}},fb6a:function(t,e,s){"use strict";var n=s("23e7"),i=s("861d"),r=s("e8b5"),o=s("23cb"),a=s("50c4"),c=s("fc6a"),u=s("8418"),d=s("b622"),l=s("1dde"),m=s("ae40"),h=l("slice"),g=m("slice",{ACCESSORS:!0,0:0,1:2}),f=d("species"),p=[].slice,v=Math.max;n({target:"Array",proto:!0,forced:!h||!g},{slice:function(t,e){var s,n,d,l=c(this),m=a(l.length),h=o(t,m),g=o(void 0===e?m:e,m);if(r(l)&&(s=l.constructor,"function"!=typeof s||s!==Array&&!r(s.prototype)?i(s)&&(s=s[f],null===s&&(s=void 0)):s=void 0,s===Array||void 0===s))return p.call(l,h,g);for(n=new(void 0===s?Array:s)(v(g-h,0)),d=0;h<g;h++,d++)h in l&&u(n,d,l[h]);return n.length=d,n}})}}]);
//# sourceMappingURL=chunk-4eae587d.e22b3f58.js.map