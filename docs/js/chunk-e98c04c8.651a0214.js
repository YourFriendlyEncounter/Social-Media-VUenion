(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e98c04c8"],{"0510":function(t,e,s){"use strict";var i=s("a420"),n=s.n(i);n.a},"21e3":function(t,e,s){},2532:function(t,e,s){"use strict";var i=s("23e7"),n=s("5a34"),o=s("1d80"),r=s("ab13");i({target:"String",proto:!0,forced:!r("includes")},{includes:function(t){return!!~String(o(this)).indexOf(n(t),arguments.length>1?arguments[1]:void 0)}})},"2f65":function(t,e,s){var i={"./anonymous.svg":"2456","./newUser.svg":"6364","./web.svg":"c31f"};function n(t){var e=o(t);return s(e)}function o(t){if(!s.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}n.keys=function(){return Object.keys(i)},n.resolve=o,t.exports=n,n.id="2f65"},"2fd9":function(t,e,s){},"41dd":function(t,e,s){"use strict";var i=s("ad30"),n=s.n(i);n.a},"44e7":function(t,e,s){var i=s("861d"),n=s("c6b6"),o=s("b622"),r=o("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==n(t))}},4787:function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"feed"}},[s("PostSection",{attrs:{field:"feed"}})],1)},n=[],o=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-section"},[t.checkUser?s("NewPublication",{attrs:{placeholder:"Что интересного можете рассказать?",field:t.field}}):t._e(),t.isLoading?s("Loading",{attrs:{displayWhatLoading:!1}}):s("div",{staticClass:"target-publications"},t._l(t.getPosts,(function(t){return s("Publication",{key:t.id,attrs:{post:t}})})),1)],1)},r=[],a=(s("4de4"),s("fb6a"),s("96cf"),s("1da1")),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container-white post-generic"},[s("div",{staticClass:"post-author-info"},[s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("div",{staticClass:"post-author-photo-block"},[s("img",{attrs:{src:t.getUserImageURL(t.post.user).link,width:"48",height:"48"}})]),s("div",{staticClass:"post-author-name-date-block"},[s("router-link",{staticClass:"link-user",attrs:{to:{name:"UserProfile",params:{id:t.post.user}}}},[t._v(" "+t._s(t.getAuthorById(t.post.user).name)+" "+t._s(t.getAuthorById(t.post.user).lastName)+" ")]),s("p",[t._v(" "+t._s(t.getRelativeDate(t.post.dateTimeAdded))+" ")])],1)]),t.getUser.id==t.post.user||t.isUserAdmin?s("a",{staticClass:"post-delete",attrs:{href:"#"},on:{click:function(e){return t.deletePostOrComment(t.post)}}},[t._v("X")]):t._e()]),s("p",{staticClass:"post-text"},[t._v(t._s(t.post.text))]),t.post.images?s("div",[s("hr"),s("div",{staticClass:"post-images"},t._l(t.getImagesForPost,(function(t){return s("div",{key:t.link,staticClass:"post-image"},[s("a",{attrs:{href:t.link}},[s("img",{attrs:{src:t.link,width:"96",height:"64"}})])])})),0)]):t._e(),s("hr"),s("Rating",{attrs:{post:t.post,canAddComment:!0}}),s("div",{staticClass:"post-comment-section"},[t.getComments(t.post.id).length>0?s("div",[s("hr"),t._l(t.getComments(t.post.id),(function(e){return s("Comment",{key:e.id,attrs:{comment:e,deletePostOrComment:t.deletePostOrComment,getUserImageURL:t.getUserImageURL,getAuthorById:t.getAuthorById,getRelativeDate:t.getRelativeDate,isUserAdmin:t.isUserAdmin,isReply:!1}})}))],2):t._e(),t.checkUser&&t.post.showComment?s("NewComment",{attrs:{post:t.post,userImage:t.getUserImageURL(t.getUser.id).link,field:t.post.field}}):t._e()],1)],1)},l=[],d=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"div-likes-dislikes"},[i("p",{staticClass:"p-difference"},[t._v(t._s(t.getDifference))]),i("div",{staticClass:"tooltip"},[i("div",{staticClass:"div-tooltip-inside"},[i("h2",[t._v(t._s(t.getRatesCount(t.post.liked)))])]),i("button",{staticClass:"button-transparent-clickable button-like",class:{"is-post-liked":t.isPostLiked(t.post)},on:{click:function(e){return t.toggleLikePost(t.post)}}},[i("img",{attrs:{src:s("8e44"),width:"24"}})])]),i("div",{staticClass:"tooltip"},[i("div",{staticClass:"div-tooltip-inside"},[i("h2",[t._v(t._s(t.getRatesCount(t.post.disliked)))])]),i("button",{staticClass:"button-transparent-clickable button-dislike",class:{"is-post-disliked":t.isPostDisliked(t.post)},on:{click:function(e){return t.toggleDislikePost(t.post)}}},[i("img",{attrs:{src:s("fcd3"),width:"24"}})])]),t.canAddComment?i("button",{staticClass:"button-transparent-clickable button-comment",class:{"is-post-liked":1==t.post.showComment},on:{click:t.showCommentClicked}},[i("img",{attrs:{src:s("e306"),width:"24"}})]):t._e()])])},u=[],m=(s("caad"),s("2532"),s("d719")),g=s.n(m),h={methods:{getRatesCount:function(t){return void 0==t?0:t.length},isPostLiked:function(t){return!(!t.liked||!this.checkUser)&&t.liked.includes(this.getUser.id)},isPostDisliked:function(t){return!(!t.disliked||!this.checkUser)&&t.disliked.includes(this.getUser.id)},toggleLikePost:function(t){if(!this.isLoadingLikes)if(this.checkUser){this.isPostDisliked(t)&&this.toggleDislikePost(t);var e=this.isPostLiked(t),s=this.getUser.id;this.$store.dispatch("changeLikes",{post:t,userID:s,isToRemove:e})}else g.a.error("Авторизуйтесь, чтобы оставлять отзывы.")},toggleDislikePost:function(t){if(!this.isLoadingLikes)if(this.checkUser){this.isPostLiked(t)&&this.toggleLikePost(t);var e=this.isPostDisliked(t),s=this.getUser.id;this.$store.dispatch("changeDislikes",{post:t,userID:s,isToRemove:e})}else g.a.error("Авторизуйтесь, чтобы оставлять отзывы.")},showCommentClicked:function(){void 0==this.post.showComment&&(this.post.showComment=!1),this.post.showComment=!this.post.showComment,this.$store.dispatch("changeComponentKey")}},computed:{getUser:function(){return this.$store.getters.user},checkUser:function(){return this.$store.getters.checkUser},getDifference:function(){var t=this.getRatesCount(this.post.liked)-this.getRatesCount(this.post.disliked);return t>0&&(t="+"+t),t},isLoadingLikes:function(){return this.$store.getters.isLoadingLikes}},props:{post:Object,canAddComment:Boolean}},f=h,p=(s("0510"),s("2877")),v=Object(p["a"])(f,d,u,!1,null,"2b917899",null),k=v.exports,C=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-comment-new",class:{"is-reply-newcomment":t.isReply}},[s("div",{staticClass:"post-commment-image-block"},[s("img",{attrs:{src:t.userImage,width:"32",height:"32"}})]),s("form",{staticClass:"form-new-comment",on:{submit:function(e){return e.preventDefault(),t.newComment(t.post)}}},[s("input",{ref:"commentText",staticClass:"input-text",attrs:{type:"text",placeholder:"Напишите своё мнение..."}}),t._m(0)])])},U=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("button",{staticClass:"button-transparent-clickable",staticStyle:{height:"34px",margin:"0 0 0 4px"}},[i("img",{attrs:{src:s("1959"),width:"32",height:"32"}})])}],w=(s("d3b7"),s("25f0"),s("d4ec")),b=function t(e,s,i,n,o,r){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"post",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;Object(w["a"])(this,t),this.text=e,this.dateTimeAdded=s,this.images=i,this.edited=n,this.liked=o,this.disliked=r,this.user=a,this.id=d,this.type=c,this.target=l},P={props:{post:Object,userImage:String,isReply:Boolean,field:String},methods:{newComment:function(t){var e=this,s=this.output=this.$refs.commentText.value;if(s.length<3)g.a.error("Нельзя опубликовать комментарий, длиной менее 3 символов.");else{var i=new b;i.text=s,i.dateTimeAdded=(new Date).toString(),i.images=[],i.edited=!1,i.liked=[],i.disliked=[],i.user=this.$store.getters.user.id,i.type="comment",i.target=t.id,i.field=this.field,this.$store.dispatch("newPost",i).then((function(){e.sumbitStatus="ok",e.$router.push("/"),e.$refs.commentText.value="",t.showComment=!1})).catch((function(t){e.sumbitStatus=t.message}))}}}},y=P,_=(s("4d4f"),Object(p["a"])(y,C,U,!1,null,"093b9892",null)),R=_.exports,x=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"post-comment-outer",class:{"is-reply":t.isReply}},[s("div",{staticClass:"post-comment"},[s("div",{staticClass:"post-comment-inner"},[t.getUser.id==t.comment.user||t.isUserAdmin?s("a",{staticClass:"post-comment-delete",attrs:{href:"#"},on:{click:function(e){return t.deletePostOrComment(t.comment)}}},[t._v("X")]):t._e(),s("div",{staticClass:"post-author-photo-block"},[s("img",{attrs:{src:t.getUserImageURL(t.comment.user).link,width:"32",height:"32"}})]),s("div",{staticClass:"post-author-name-date-block"},[s("router-link",{staticClass:"link-user",attrs:{to:{name:"UserProfile",params:{id:t.comment.user}}}},[t._v(" "+t._s(t.getAuthorById(t.comment.user).name)+" "+t._s(t.getAuthorById(t.comment.user).lastName)+" ")]),s("p",[t._v(" "+t._s(t.getRelativeDate(t.comment.dateTimeAdded))+" ")])],1),s("p",{staticStyle:{"margin-left":"0.5rem","max-width":"70%"}},[t._v(t._s(t.comment.text))])]),s("div",[s("Rating",{attrs:{post:t.comment,canAddComment:!t.isReply}})],1)]),t.isReply?t._e():s("div",{staticClass:"post-comment-replies"},t._l(t.getReplies,(function(e){return s("Comment",{key:e.id,attrs:{comment:e,deletePostOrComment:t.deletePostOrComment,getUserImageURL:t.getUserImageURL,getAuthorById:t.getAuthorById,getRelativeDate:t.getRelativeDate,isUserAdmin:t.isUserAdmin,isReply:!0}})})),1),t.checkUser&&t.comment.showComment?s("NewComment",{attrs:{post:t.comment,userImage:t.getUserImageURL(t.getUser.id).link,isReply:!0,field:t.comment.field}}):t._e()],1)},I=[],L={name:"Comment",components:{Rating:k,Comment:D,NewComment:R},computed:{checkUser:function(){return this.$store.getters.checkUser},getUser:function(){return this.$store.getters.user},getReplies:function(){var t=this;return this.$store.getters.getPosts.slice().filter((function(e){return e.target==t.comment.id}))}},props:{comment:Object,deletePostOrComment:Function,getUserImageURL:Function,getAuthorById:Function,getRelativeDate:Function,isUserAdmin:Boolean,isReply:Boolean}},$=L,A=(s("9c9b"),Object(p["a"])($,x,I,!1,null,"78acb2c9",null)),D=A.exports,O={components:{Rating:k,NewComment:R,Comment:D},methods:{getAuthorById:function(t){return this.$store.getters.getUserById(t)},getUserImageURL:function(t){var e=this.getUserAvatarImageURLs.slice().filter((function(e){return e.id==t}))[0];if(!e){var i=s("2f65");e={id:"",link:i("./anonymous.svg")}}return e},getRelativeDate:function(t){var e=new Date(t),s=new Date,i=s-e,n=" мин. назад";if(i=Math.round(i/1e3/60),i>=60){if(i/=60,i=Math.floor(i),n=" ч. назад",i>=24)return e.getDate()+"."+(e.getMonth()+1)+"."+e.getFullYear()+" "+(e.getHours()<10?"0":"")+e.getHours()+":"+(e.getMinutes()<10?"0":"")+e.getMinutes()}else if(0===i)return"Только что";return i+n},getComments:function(t){return this.$store.getters.getPosts.slice().filter((function(e){return"comment"==e.type&&e.target==t}))},deletePostOrComment:function(t){var e;e="comment"==t.type?"комментарий":"пост",confirm("Вы уверены, что хотите удалить этот "+e+"? Это действие нельзя будет отменить.")&&this.$store.dispatch("deletePost",t)}},props:{post:Object},computed:{getAuthors:function(){return this.$store.getters.getUserList},checkUser:function(){return this.$store.getters.checkUser},getUser:function(){return this.$store.getters.user},isUserAdmin:function(){return this.$store.getters.getUserInfo.isAdmin},getUserAvatarImageURLs:function(){return this.$store.getters.getLoadedUserAvatarURLs},getImagesForPost:function(){var t=this;return this.$store.getters.getLoadedImagesURLs.filter((function(e){return e.id==t.post.id}))}}},S=O,T=(s("41dd"),Object(p["a"])(S,c,l,!1,null,"7c91e29c",null)),j=T.exports,E=s("3a5e"),B=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("form",{attrs:{id:"form-new-post"},on:{submit:function(e){return e.preventDefault(),t.newPost(e)}}},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newPostText,expression:"newPostText"}],staticClass:"input-text",attrs:{id:"new-post-text",rows:"3",maxlength:"3000",placeholder:t.placeholder},domProps:{value:t.newPostText},on:{input:function(e){e.target.composing||(t.newPostText=e.target.value)}}}),t._v(" "),s("div",{staticStyle:{display:"flex","justify-content":"space-between",width:"-webkit-fill-available"}},[s("div",[s("input",{ref:"file",staticClass:"input-text",attrs:{type:"file",id:"new-post-images",accept:"image/jpeg,image/jpg,image/png,image/gif",multiple:""},on:{change:function(e){return t.handleFileUpload()}}})]),s("input",{staticClass:"custom-button",attrs:{type:"submit",id:"new-post-submit"}})])])},F=[],N={props:{placeholder:String,field:String},computed:{},methods:{handleFileUpload:function(){this.newPostImages=this.$refs.file.files},newPost:function(){var t=this;if(this.newPostText.length<3)g.a.error("Нельзя опубликовать пост, длиной менее 3 символов.");else if(this.newPostImages.length>10)g.a.error("Нельзя опубликовать более 10 картинок в одном посте.");else{var e={};e.text=this.newPostText,e.dateTimeAdded=(new Date).toString(),e.images=this.newPostImages.length>0,e.edited=!1,e.liked=[],e.disliked=[],e.user=this.$store.getters.user.id,e.type="post",e.target=this.field,e.field=this.field,this.$store.dispatch("newPost",e).then((function(s){if(t.sumbitStatus="ok",e.images)for(var i=0;i<t.newPostImages.length;i++){var n="posts/"+s+"/"+i,o=t.newPostImages[i];t.$store.dispatch("sendFile",{link:n,file:o})}t.$router.push("/"),t.newPostText="",t.newPostImages=[]})).catch((function(e){t.sumbitStatus=e.message}))}}},data:function(){return{newPostText:"",newPostImages:[]}}},M=N,H=(s("c61c"),Object(p["a"])(M,B,F,!1,null,"ab979cbe",null)),J=H.exports,X={components:{Publication:j,Loading:E["a"],NewPublication:J},props:{field:String},data:function(){return{updateTimer:null}},created:function(){this.loadEverything()},beforeDestroy:function(){clearInterval(this.updateTimer)},mounted:function(){var t=this;this.updateTimer=setInterval((function(){t.$store.dispatch("updatePosts",{field:t.field}),console.log("Данные подгружены...")}),1e4)},computed:{checkUser:function(){return this.$store.getters.checkUser},getPosts:function(){var t=this;return this.$store.getters.getPosts.slice().filter((function(e){return e.field==t.field&&"comment"!=e.type})).reverse()},isLoading:function(){return this.$store.getters.getLoadingCurrentUser||this.$store.getters.getLoadingUserInfos||this.$store.getters.isSending||this.$store.getters.isLoadingFiles},getUserAvatarImageURLs:function(){return this.$store.getters.getLoadedUserAvatarURLs}},methods:{loadPosts:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("loadPosts",{field:t.field});case 2:case"end":return e.stop()}}),e)})))()},loadUserAvatars:function(){this.$store.dispatch("loadUserAvatarURLs",{posts:this.getPosts})},loadPostImages:function(){this.$store.dispatch("loadPostImagesURLs",{posts:this.getPosts})},loadEverything:function(){var t=this;this.loadPosts().then((function(){0==t.getUserAvatarImageURLs.length&&(t.loadUserAvatars(),t.loadPostImages())}))}}},K=X,W=Object(p["a"])(K,o,r,!1,null,null,null),Y=W.exports,q={components:{PostSection:Y},data:function(){return{updateTimer:null}}},z=q,G=(s("55d8"),Object(p["a"])(z,i,n,!1,null,"9a4a377e",null));e["default"]=G.exports},"4d4f":function(t,e,s){"use strict";var i=s("21e3"),n=s.n(i);n.a},"55d8":function(t,e,s){"use strict";var i=s("2fd9"),n=s.n(i);n.a},"592f":function(t,e,s){},"5a34":function(t,e,s){var i=s("44e7");t.exports=function(t){if(i(t))throw TypeError("The method doesn't accept regular expressions");return t}},"9c9b":function(t,e,s){"use strict";var i=s("592f"),n=s.n(i);n.a},a420:function(t,e,s){},ab13:function(t,e,s){var i=s("b622"),n=i("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(s){try{return e[n]=!1,"/./"[t](e)}catch(i){}}return!1}},ad30:function(t,e,s){},c61c:function(t,e,s){"use strict";var i=s("d323"),n=s.n(i);n.a},caad:function(t,e,s){"use strict";var i=s("23e7"),n=s("4d64").includes,o=s("44d2"),r=s("ae40"),a=r("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:!a},{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),o("includes")},d323:function(t,e,s){},fb6a:function(t,e,s){"use strict";var i=s("23e7"),n=s("861d"),o=s("e8b5"),r=s("23cb"),a=s("50c4"),c=s("fc6a"),l=s("8418"),d=s("b622"),u=s("1dde"),m=s("ae40"),g=u("slice"),h=m("slice",{ACCESSORS:!0,0:0,1:2}),f=d("species"),p=[].slice,v=Math.max;i({target:"Array",proto:!0,forced:!g||!h},{slice:function(t,e){var s,i,d,u=c(this),m=a(u.length),g=r(t,m),h=r(void 0===e?m:e,m);if(o(u)&&(s=u.constructor,"function"!=typeof s||s!==Array&&!o(s.prototype)?n(s)&&(s=s[f],null===s&&(s=void 0)):s=void 0,s===Array||void 0===s))return p.call(u,g,h);for(i=new(void 0===s?Array:s)(v(h-g,0)),d=0;g<h;g++,d++)g in u&&l(i,d,u[g]);return i.length=d,i}})}}]);
//# sourceMappingURL=chunk-e98c04c8.651a0214.js.map